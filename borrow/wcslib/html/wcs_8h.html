<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>WCSLIB 4.6.3: wcs.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>wcs.h File Reference</h1><code>#include &quot;<a class="el" href="lin_8h-source.html">lin.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="cel_8h-source.html">cel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="spc_8h-source.html">spc.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="tab_8h-source.html">tab.h</a>&quot;</code><br>

<p>
<a href="wcs_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpvcard.html">pvcard</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store for <code><b>PV</b>i<b>_</b>ma</code> keyrecords.  <a href="structpvcard.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpscard.html">pscard</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store for <code><b>PS</b>i<b>_</b>ma</code> keyrecords.  <a href="structpscard.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structwtbarr.html">wtbarr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extraction of coordinate lookup tables from BINTABLE.  <a href="structwtbarr.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structwcsprm.html">wcsprm</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Coordinate transformation parameters.  <a href="structwcsprm.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#0653c98b8a1bee5755740ae3f4854094">WCSSUB_LONGITUDE</a>&nbsp;&nbsp;&nbsp;0x1001</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mask for extraction of longitude axis by <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>.  <a href="#0653c98b8a1bee5755740ae3f4854094"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#5d377c202850ee0eaf44b3e989d0736e">WCSSUB_LATITUDE</a>&nbsp;&nbsp;&nbsp;0x1002</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mask for extraction of latitude axis by <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>.  <a href="#5d377c202850ee0eaf44b3e989d0736e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#22bbac394b025c4cfc7bd73b6d6e3962">WCSSUB_CUBEFACE</a>&nbsp;&nbsp;&nbsp;0x1004</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mask for extraction of <b><code>CUBEFACE</code></b> axis by <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>.  <a href="#22bbac394b025c4cfc7bd73b6d6e3962"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#b9885b02031ff7aa7b094f4a1edee2cd">WCSSUB_CELESTIAL</a>&nbsp;&nbsp;&nbsp;0x1007</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mask for extraction of celestial axes by <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>.  <a href="#b9885b02031ff7aa7b094f4a1edee2cd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#4b2dfca2e80fe80ba85dc830cd9c377b">WCSSUB_SPECTRAL</a>&nbsp;&nbsp;&nbsp;0x1008</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mask for extraction of spectral axis by <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>.  <a href="#4b2dfca2e80fe80ba85dc830cd9c377b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#6ba6d2640572b12a11e3558fa75a01ed">WCSSUB_STOKES</a>&nbsp;&nbsp;&nbsp;0x1010</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mask for extraction of <b><code>STOKES</code></b> axis by <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>.  <a href="#6ba6d2640572b12a11e3558fa75a01ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#6852f6dd2883c82296f1108b897d337e">WCSLEN</a>&nbsp;&nbsp;&nbsp;(sizeof(struct <a class="el" href="structwcsprm.html">wcsprm</a>)/sizeof(int))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct in int units.  <a href="#6852f6dd2883c82296f1108b897d337e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#c55946dadc53ac592cb686275902ae7b">wcscopy</a>(alloc, wcssrc, wcsdst)&nbsp;&nbsp;&nbsp;wcssub(alloc, wcssrc, 0, 0, wcsdst)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy routine for the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct.  <a href="#c55946dadc53ac592cb686275902ae7b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#1bcf49cfe1ed1bb2bc4c930f98d808fa">wcsini_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#1bcf49cfe1ed1bb2bc4c930f98d808fa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#465ef3c77aaf546324dae0692e6de7fe">wcssub_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#465ef3c77aaf546324dae0692e6de7fe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#e1738854472218541bda531653ef2709">wcscopy_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#e1738854472218541bda531653ef2709"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#3d64b57cec404114c75bd25a562e8053">wcsfree_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#3d64b57cec404114c75bd25a562e8053"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#8f5c31a6983b17abbe2fead61550d55c">wcsprt_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#8f5c31a6983b17abbe2fead61550d55c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#84a67c964e212bbf004c264b3ca70fee">wcsset_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#84a67c964e212bbf004c264b3ca70fee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#de3959355dc9d0987e7ccc4070795c38">wcsp2s_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#de3959355dc9d0987e7ccc4070795c38"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#37c4884cf58baf25b2984ec3bccb80a5">wcss2p_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#37c4884cf58baf25b2984ec3bccb80a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#cfbadc770489b6b5186b95eaa35467f1">wcsmix_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#cfbadc770489b6b5186b95eaa35467f1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#42b2578d76ace7ca6114d82b7ae46a89">wcsnpv</a> (int n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Memory allocation for <code><b>PV</b>i<b>_</b>ma</code>.  <a href="#42b2578d76ace7ca6114d82b7ae46a89"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#e790c9ce6c9b7a4845cf1c3c97b1e97a">wcsnps</a> (int n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Memory allocation for <code><b>PS</b>i<b>_</b>ma</code>.  <a href="#e790c9ce6c9b7a4845cf1c3c97b1e97a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45">wcsini</a> (int alloc, int naxis, struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor for the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct.  <a href="#2afc8255fde0965dddaa374463666d45"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64">wcssub</a> (int alloc, const struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcssrc, int *nsub, int axes[], struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcsdst)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Subimage extraction routine for the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct.  <a href="#864c99fef9f3eee29085ce42d0ee0d64"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#4ab38bc642c4656f62c43acf84a849f1">wcsfree</a> (struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor for the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct.  <a href="#4ab38bc642c4656f62c43acf84a849f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#b9aeb8cf1afb1bfb22e989580d90fca8">wcsprt</a> (const struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print routine for the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct.  <a href="#b9aeb8cf1afb1bfb22e989580d90fca8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#e5cc3f5d249755583403cdf54d2ebb91">wcsset</a> (struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup routine for the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct.  <a href="#e5cc3f5d249755583403cdf54d2ebb91"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#27d3dd209db3e76cf4c50f48c01ba986">wcsp2s</a> (struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs, int ncoord, int nelem, const double pixcrd[], double imgcrd[], double phi[], double theta[], double world[], int stat[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pixel-to-world transformation.  <a href="#27d3dd209db3e76cf4c50f48c01ba986"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#60673d05a3513659ac848a9cb3d0cb07">wcss2p</a> (struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs, int ncoord, int nelem, const double world[], double phi[], double theta[], double imgcrd[], double pixcrd[], int stat[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">World-to-pixel transformation.  <a href="#60673d05a3513659ac848a9cb3d0cb07"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#f3f00b876c8212d43f32a51feeadaa81">wcsmix</a> (struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs, int mixpix, int mixcel, const double vspan[], double vstep, int viter, double world[], double phi[], double theta[], double imgcrd[], double pixcrd[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hybrid coordinate transformation.  <a href="#f3f00b876c8212d43f32a51feeadaa81"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#57975833fe0588eb7c7b6d79f13a7693">wcssptr</a> (struct <a class="el" href="structwcsprm.html">wcsprm</a> *wcs, int *i, char ctype[9])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Spectral axis translation.  <a href="#57975833fe0588eb7c7b6d79f13a7693"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a> []</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Status return messages.  <a href="#d16bd8db875ee05b014429efdc1f3471"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
These routines implement the FITS World Coordinate System (WCS) standard which defines methods to be used for computing world coordinates from image pixel coordinates, and vice versa. They are based on the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct which contains all information needed for the computations. The struct contains some members that must be set by the user, and others that are maintained by these routines, somewhat like a C++ class but with no encapsulation.<p>
Three routines, <a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45" title="Default constructor for the wcsprm struct.">wcsini()</a>, <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>, and <a class="el" href="wcs_8h.html#4ab38bc642c4656f62c43acf84a849f1" title="Destructor for the wcsprm struct.">wcsfree()</a> are provided to manage the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct and another, <a class="el" href="wcs_8h.html#b9aeb8cf1afb1bfb22e989580d90fca8" title="Print routine for the wcsprm struct.">wcsprt()</a>, to prints its contents. Refer to the description of the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct for an explanation of the anticipated usage of these routines. <a class="el" href="wcs_8h.html#c55946dadc53ac592cb686275902ae7b" title="Copy routine for the wcsprm struct.">wcscopy()</a>, which does a deep copy of one <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct to another, is defined as a preprocessor macro function that invokes <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>.<p>
A setup routine, <a class="el" href="wcs_8h.html#e5cc3f5d249755583403cdf54d2ebb91" title="Setup routine for the wcsprm struct.">wcsset()</a>, computes intermediate values in the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct from parameters in it that were supplied by the user. The struct always needs to be set up by <a class="el" href="wcs_8h.html#e5cc3f5d249755583403cdf54d2ebb91" title="Setup routine for the wcsprm struct.">wcsset()</a> but this need not be called explicitly - refer to the explanation of <a class="el" href="structwcsprm.html#35bff8de85e5a8892e1b68db69ca7a68">wcsprm::flag</a>.<p>
<a class="el" href="wcs_8h.html#27d3dd209db3e76cf4c50f48c01ba986" title="Pixel-to-world transformation.">wcsp2s()</a> and <a class="el" href="wcs_8h.html#60673d05a3513659ac848a9cb3d0cb07" title="World-to-pixel transformation.">wcss2p()</a> implement the WCS world coordinate transformations. In fact, they are high level driver routines for the WCS linear, logarithmic, celestial, spectral and tabular transformation routines described in <a class="el" href="lin_8h.html">lin.h</a>, <a class="el" href="log_8h.html">log.h</a>, <a class="el" href="cel_8h.html">cel.h</a>, <a class="el" href="spc_8h.html">spc.h</a> and <a class="el" href="tab_8h.html">tab.h</a>.<p>
Given either the celestial longitude or latitude plus an element of the pixel coordinate a hybrid routine, <a class="el" href="wcs_8h.html#f3f00b876c8212d43f32a51feeadaa81" title="Hybrid coordinate transformation.">wcsmix()</a>, iteratively solves for the unknown elements.<p>
<a class="el" href="wcs_8h.html#57975833fe0588eb7c7b6d79f13a7693" title="Spectral axis translation.">wcssptr()</a> translates the spectral axis in a <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct. For example, a '<code><b>FREQ</b></code>' axis may be translated into <code><b>'ZOPT-F2W'</b></code> and vice versa.<p>
<b>Quadcube projections:</b> <br>
 The quadcube projections (<code><b>TSC</b></code>, <code><b>CSC</b></code>, <code><b>QSC</b></code>) may be represented in FITS in either of two ways:<p>
a: The six faces may be laid out in one plane and numbered as follows: <div class="fragment"><pre class="fragment">                                  0
 
                         4  3  2  1  4  3  2
 
                                  5
</pre></div><p>
Faces 2, 3 and 4 may appear on one side or the other (or both). The world-to-pixel routines map faces 2, 3 and 4 to the left but the pixel-to-world routines accept them on either side.<p>
b: The "COBE" convention in which the six faces are stored in a three-dimensional structure using a <code><b>CUBEFACE</b></code> axis indexed from 0 to 5 as above.<p>
These routines support both methods; <a class="el" href="wcs_8h.html#e5cc3f5d249755583403cdf54d2ebb91" title="Setup routine for the wcsprm struct.">wcsset()</a> determines which is being used by the presence or absence of a <code><b>CUBEFACE</b></code> axis in ctype[]. <a class="el" href="wcs_8h.html#27d3dd209db3e76cf4c50f48c01ba986" title="Pixel-to-world transformation.">wcsp2s()</a> and <a class="el" href="wcs_8h.html#60673d05a3513659ac848a9cb3d0cb07" title="World-to-pixel transformation.">wcss2p()</a> translate the <code><b>CUBEFACE</b></code> axis representation to the single plane representation understood by the lower-level WCSLIB projection routines. <hr><h2>Define Documentation</h2>
<a class="anchor" name="0653c98b8a1bee5755740ae3f4854094"></a><!-- doxytag: member="wcs.h::WCSSUB_LONGITUDE" ref="0653c98b8a1bee5755740ae3f4854094" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WCSSUB_LONGITUDE&nbsp;&nbsp;&nbsp;0x1001          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mask to use for extracting the longitude axis when sub-imaging, refer to the <em>axes</em> argument of <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>. 
</div>
</div><p>
<a class="anchor" name="5d377c202850ee0eaf44b3e989d0736e"></a><!-- doxytag: member="wcs.h::WCSSUB_LATITUDE" ref="5d377c202850ee0eaf44b3e989d0736e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WCSSUB_LATITUDE&nbsp;&nbsp;&nbsp;0x1002          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mask to use for extracting the latitude axis when sub-imaging, refer to the <em>axes</em> argument of <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>. 
</div>
</div><p>
<a class="anchor" name="22bbac394b025c4cfc7bd73b6d6e3962"></a><!-- doxytag: member="wcs.h::WCSSUB_CUBEFACE" ref="22bbac394b025c4cfc7bd73b6d6e3962" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WCSSUB_CUBEFACE&nbsp;&nbsp;&nbsp;0x1004          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mask to use for extracting the <b><code>CUBEFACE</code></b> axis when sub-imaging, refer to the <em>axes</em> argument of <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>. 
</div>
</div><p>
<a class="anchor" name="b9885b02031ff7aa7b094f4a1edee2cd"></a><!-- doxytag: member="wcs.h::WCSSUB_CELESTIAL" ref="b9885b02031ff7aa7b094f4a1edee2cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WCSSUB_CELESTIAL&nbsp;&nbsp;&nbsp;0x1007          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mask to use for extracting the celestial axes (longitude, latitude and cubeface) when sub-imaging, refer to the <em>axes</em> argument of <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>. 
</div>
</div><p>
<a class="anchor" name="4b2dfca2e80fe80ba85dc830cd9c377b"></a><!-- doxytag: member="wcs.h::WCSSUB_SPECTRAL" ref="4b2dfca2e80fe80ba85dc830cd9c377b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WCSSUB_SPECTRAL&nbsp;&nbsp;&nbsp;0x1008          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mask to use for extracting the spectral axis when sub-imaging, refer to the <em>axes</em> argument of <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>. 
</div>
</div><p>
<a class="anchor" name="6ba6d2640572b12a11e3558fa75a01ed"></a><!-- doxytag: member="wcs.h::WCSSUB_STOKES" ref="6ba6d2640572b12a11e3558fa75a01ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WCSSUB_STOKES&nbsp;&nbsp;&nbsp;0x1010          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mask to use for extracting the <b><code>STOKES</code></b> axis when sub-imaging, refer to the <em>axes</em> argument of <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a>. 
</div>
</div><p>
<a class="anchor" name="6852f6dd2883c82296f1108b897d337e"></a><!-- doxytag: member="wcs.h::WCSLEN" ref="6852f6dd2883c82296f1108b897d337e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WCSLEN&nbsp;&nbsp;&nbsp;(sizeof(struct <a class="el" href="structwcsprm.html">wcsprm</a>)/sizeof(int))          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Size of the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct in <em>int</em> units, used by the Fortran wrappers. 
</div>
</div><p>
<a class="anchor" name="c55946dadc53ac592cb686275902ae7b"></a><!-- doxytag: member="wcs.h::wcscopy" ref="c55946dadc53ac592cb686275902ae7b" args="(alloc, wcssrc, wcsdst)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcscopy          </td>
          <td>(</td>
          <td class="paramtype">alloc,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wcssrc,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wcsdst&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;wcssub(alloc, wcssrc, 0, 0, wcsdst)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcscopy</b>() does a deep copy of one <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct to another. As of WCSLIB 3.6, it is implemented as a preprocessor macro that invokes <a class="el" href="wcs_8h.html#864c99fef9f3eee29085ce42d0ee0d64" title="Subimage extraction routine for the wcsprm struct.">wcssub()</a> with the nsub and axes pointers both set to zero. 
</div>
</div><p>
<a class="anchor" name="1bcf49cfe1ed1bb2bc4c930f98d808fa"></a><!-- doxytag: member="wcs.h::wcsini_errmsg" ref="1bcf49cfe1ed1bb2bc4c930f98d808fa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcsini_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000031">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="465ef3c77aaf546324dae0692e6de7fe"></a><!-- doxytag: member="wcs.h::wcssub_errmsg" ref="465ef3c77aaf546324dae0692e6de7fe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcssub_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000032">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="e1738854472218541bda531653ef2709"></a><!-- doxytag: member="wcs.h::wcscopy_errmsg" ref="e1738854472218541bda531653ef2709" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcscopy_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000033">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="3d64b57cec404114c75bd25a562e8053"></a><!-- doxytag: member="wcs.h::wcsfree_errmsg" ref="3d64b57cec404114c75bd25a562e8053" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcsfree_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000034">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="8f5c31a6983b17abbe2fead61550d55c"></a><!-- doxytag: member="wcs.h::wcsprt_errmsg" ref="8f5c31a6983b17abbe2fead61550d55c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcsprt_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000035">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="84a67c964e212bbf004c264b3ca70fee"></a><!-- doxytag: member="wcs.h::wcsset_errmsg" ref="84a67c964e212bbf004c264b3ca70fee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcsset_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000036">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="de3959355dc9d0987e7ccc4070795c38"></a><!-- doxytag: member="wcs.h::wcsp2s_errmsg" ref="de3959355dc9d0987e7ccc4070795c38" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcsp2s_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000037">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="37c4884cf58baf25b2984ec3bccb80a5"></a><!-- doxytag: member="wcs.h::wcss2p_errmsg" ref="37c4884cf58baf25b2984ec3bccb80a5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcss2p_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000038">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="cfbadc770489b6b5186b95eaa35467f1"></a><!-- doxytag: member="wcs.h::wcsmix_errmsg" ref="cfbadc770489b6b5186b95eaa35467f1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wcsmix_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000039">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471" title="Status return messages.">wcs_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="42b2578d76ace7ca6114d82b7ae46a89"></a><!-- doxytag: member="wcs.h::wcsnpv" ref="42b2578d76ace7ca6114d82b7ae46a89" args="(int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsnpv           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsnpv</b>() changes the value of NPVMAX (default 64). This global variable controls the number of <code><b>PV</b>i<b>_</b>ma</code> keywords that <a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45" title="Default constructor for the wcsprm struct.">wcsini()</a> should allocate space for.<p>
<b>PLEASE NOTE:</b> This function is not thread-safe.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>n</em>&nbsp;</td><td>Value of NPVMAX; ignored if &lt; 0.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Current value of NPVMAX. </dd></dl>

</div>
</div><p>
<a class="anchor" name="e790c9ce6c9b7a4845cf1c3c97b1e97a"></a><!-- doxytag: member="wcs.h::wcsnps" ref="e790c9ce6c9b7a4845cf1c3c97b1e97a" args="(int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsnps           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsnps</b>() changes the values of NPSMAX (default 8). This global variable controls the number of <code><b>PS</b>i<b>_</b>ma</code> keywords that <a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45" title="Default constructor for the wcsprm struct.">wcsini()</a> should allocate space for.<p>
<b>PLEASE NOTE:</b> This function is not thread-safe.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>n</em>&nbsp;</td><td>Value of NPSMAX; ignored if &lt; 0.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Current value of NPSMAX. </dd></dl>

</div>
</div><p>
<a class="anchor" name="2afc8255fde0965dddaa374463666d45"></a><!-- doxytag: member="wcs.h::wcsini" ref="2afc8255fde0965dddaa374463666d45" args="(int alloc, int naxis, struct wcsprm *wcs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsini           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>alloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>naxis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsini</b>() optionally allocates memory for arrays in a <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct and sets all members of the struct to default values. Memory is allocated for up to NPVMAX <code><b>PV</b>i<b>_</b>ma</code> keywords or NPSMAX <code><b>PS</b>i<b>_</b>ma</code> keywords per WCS representation. These may be changed via <a class="el" href="wcs_8h.html#42b2578d76ace7ca6114d82b7ae46a89" title="Memory allocation for PVi_ma.">wcsnpv()</a> and <a class="el" href="wcs_8h.html#e790c9ce6c9b7a4845cf1c3c97b1e97a" title="Memory allocation for PSi_ma.">wcsnps()</a> before <b>wcsini</b>() is called.<p>
<b>PLEASE NOTE:</b> every <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct should be initialized by <b>wcsini</b>(), possibly repeatedly. On the first invokation, and only the first invokation, <a class="el" href="structwcsprm.html#35bff8de85e5a8892e1b68db69ca7a68">wcsprm::flag</a> must be set to -1 to initialize memory management, regardless of whether <b>wcsini</b>() will actually be used to allocate memory.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alloc</em>&nbsp;</td><td>If true, allocate memory unconditionally for the crpix, etc. arrays. <br>
 If false, it is assumed that pointers to these arrays have been set by the user except if they are null pointers in which case memory will be allocated for them regardless. (In other words, setting alloc true saves having to initalize these pointers to zero.) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>naxis</em>&nbsp;</td><td>The number of world coordinate axes. This is used to determine the length of the various <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> vectors and matrices and therefore the amount of memory to allocate for them.</td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Coordinate transformation parameters. <br>
 Note that, in order to initialize memory management, <a class="el" href="structwcsprm.html#35bff8de85e5a8892e1b68db69ca7a68">wcsprm::flag</a> should be set to -1 when wcs is initialized for the first time (memory leaks may result if it had already been initialized).</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed.</li><li>2: Memory allocation failed. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="864c99fef9f3eee29085ce42d0ee0d64"></a><!-- doxytag: member="wcs.h::wcssub" ref="864c99fef9f3eee29085ce42d0ee0d64" args="(int alloc, const struct wcsprm *wcssrc, int *nsub, int axes[], struct wcsprm *wcsdst)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcssub           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>alloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcssrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nsub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>axes</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcsdst</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcssub</b>() extracts the coordinate description for a subimage from a <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct. It does a deep copy, using <a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45" title="Default constructor for the wcsprm struct.">wcsini()</a> to allocate memory for its arrays if required. Only the "information to be provided" part of the struct is extracted; a call to <a class="el" href="wcs_8h.html#e5cc3f5d249755583403cdf54d2ebb91" title="Setup routine for the wcsprm struct.">wcsset()</a> is required to set up the remainder.<p>
The world coordinate system of the subimage must be separable in the sense that the world coordinates at any point in the subimage must depend only on the pixel coordinates of the axes extracted. In practice, this means that the <code><b>PC</b>i<b>_</b>ja</code> matrix of the original image must not contain non-zero off-diagonal terms that associate any of the subimage axes with any of the non-subimage axes.<p>
Note that while the required elements of the <a class="el" href="structtabprm.html" title="Tabular transformation parameters.">tabprm</a> array are extracted, the <a class="el" href="structwtbarr.html" title="Extraction of coordinate lookup tables from BINTABLE.">wtbarr</a> array is not. (Thus it is not appropriate to call <b>wcssub</b>() after <a class="el" href="wcshdr_8h.html#6dd857f7b61a5b349cc8af5a4b6d8a1c" title="Tabular construction routine.">wcstab()</a> but before filling the <a class="el" href="structtabprm.html" title="Tabular transformation parameters.">tabprm</a> structs - refer to <a class="el" href="wcshdr_8h.html">wcshdr.h</a>.)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alloc</em>&nbsp;</td><td>If true, allocate memory for the crpix, etc. arrays in the destination. Otherwise, it is assumed that pointers to these arrays have been set by the user except if they are null pointers in which case memory will be allocated for them regardless. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>wcssrc</em>&nbsp;</td><td>Struct to extract from.</td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>nsub</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>axes</em>&nbsp;</td><td>Vector of length *nsub containing the image axis numbers (1-relative) to extract. Order is significant; axes[0] is the axis number of the input image that corresponds to the first axis in the subimage, etc. <br>
 nsub (the pointer) may be set to zero, and so also may nsub, to indicate the number of axes in the input image; the number of axes will be returned if nsub != 0. axes itself (the pointer) may be set to zero to indicate the first *nsub axes in their original order. <br>
 Set both nsub and axes to zero to do a deep copy of one <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct to another. <br>
 Subimage extraction by coordinate axis type may be done by setting the elements of axes[] to the following special preprocessor macro values: <br>
<ul>
<li>WCSSUB_LONGITUDE: Celestial longitude.</li><li>WCSSUB_LATITUDE: Celestial latitude.</li><li>WCSSUB_CUBEFACE: Quadcube <code><b>CUBEFACE</b></code> axis.</li><li>WCSSUB_SPECTRAL: Spectral axis.</li><li>WCSSUB_STOKES: Stokes axis.</li></ul>
Refer to the notes (below) for further usage examples. <br>
 On return, *nsub will contain the number of axes in the subimage; this may be zero if there were no axes of the required type(s) (in which case no memory will be allocated). axes[] will contain the axis numbers that were extracted. The vector length must be sufficient to contain all axis numbers. No checks are performed to verify that the coordinate axes are consistent, this is done by <a class="el" href="wcs_8h.html#e5cc3f5d249755583403cdf54d2ebb91" title="Setup routine for the wcsprm struct.">wcsset()</a>. </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>wcsdst</em>&nbsp;</td><td>Struct describing the subimage. <a class="el" href="structwcsprm.html#35bff8de85e5a8892e1b68db69ca7a68">wcsprm::flag</a> should be set to -1 if wcsdst was not previously initialized (memory leaks may result if it was previously initialized).</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed.</li><li>2: Memory allocation failed.</li></ul>
12: Invalid subimage specification. 13: Non-separable subimage coordinate system.</dd></dl>
<b>Notes:</b> <br>
 Combinations of subimage axes of particular types may be extracted in the same order as they occur in the input image by combining preprocessor codes, for example <div class="fragment"><pre class="fragment">      *nsub = 1;
      axes[0] = <a class="code" href="wcs_8h.html#0653c98b8a1bee5755740ae3f4854094" title="Mask for extraction of longitude axis by wcssub().">WCSSUB_LONGITUDE</a> | <a class="code" href="wcs_8h.html#5d377c202850ee0eaf44b3e989d0736e" title="Mask for extraction of latitude axis by wcssub().">WCSSUB_LATITUDE</a> | <a class="code" href="wcs_8h.html#4b2dfca2e80fe80ba85dc830cd9c377b" title="Mask for extraction of spectral axis by wcssub().">WCSSUB_SPECTRAL</a>;
</pre></div><p>
would extract the longitude, latitude, and spectral axes in the same order as the input image. If one of each were present, *nsub = 3 would be returned.<p>
For convenience, WCSSUB_CELESTIAL is defined as the combination WCSSUB_LONGITUDE | WCSSUB_LATITUDE | WCSSUB_CUBEFACE.<p>
The codes may also be negated to extract all but the types specified, for example <div class="fragment"><pre class="fragment">      *nsub = 4;
      axes[0] = <a class="code" href="wcs_8h.html#0653c98b8a1bee5755740ae3f4854094" title="Mask for extraction of longitude axis by wcssub().">WCSSUB_LONGITUDE</a>;
      axes[1] = <a class="code" href="wcs_8h.html#5d377c202850ee0eaf44b3e989d0736e" title="Mask for extraction of latitude axis by wcssub().">WCSSUB_LATITUDE</a>;
      axes[2] = <a class="code" href="wcs_8h.html#22bbac394b025c4cfc7bd73b6d6e3962" title="Mask for extraction of CUBEFACE axis by wcssub().">WCSSUB_CUBEFACE</a>;
      axes[3] = -(<a class="code" href="wcs_8h.html#4b2dfca2e80fe80ba85dc830cd9c377b" title="Mask for extraction of spectral axis by wcssub().">WCSSUB_SPECTRAL</a> | <a class="code" href="wcs_8h.html#6ba6d2640572b12a11e3558fa75a01ed" title="Mask for extraction of STOKES axis by wcssub().">WCSSUB_STOKES</a>);
</pre></div><p>
The last of these specifies all axis types other than spectral or Stokes. Extraction is done in the order specified by axes[] a longitude axis (if present) would be extracted first (via axes[0]) and not subsequently (via axes[3]). Likewise for the latitude and cubeface axes in this example.<p>
From the foregoing, it is apparent that the value of *nsub returned may be less than or greater than that given. However, it will never exceed the number of axes in the input image. 
</div>
</div><p>
<a class="anchor" name="4ab38bc642c4656f62c43acf84a849f1"></a><!-- doxytag: member="wcs.h::wcsfree" ref="4ab38bc642c4656f62c43acf84a849f1" args="(struct wcsprm *wcs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsfree           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsfree</b>() frees memory allocated for the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> arrays by <a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45" title="Default constructor for the wcsprm struct.">wcsini()</a> and/or <a class="el" href="wcs_8h.html#e5cc3f5d249755583403cdf54d2ebb91" title="Setup routine for the wcsprm struct.">wcsset()</a>. <a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45" title="Default constructor for the wcsprm struct.">wcsini()</a> records the memory it allocates and <b>wcsfree</b>() will only attempt to free this.<p>
<b>PLEASE NOTE:</b> <b>wcsfree</b>() must not be invoked on a <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct that was not initialized by <a class="el" href="wcs_8h.html#2afc8255fde0965dddaa374463666d45" title="Default constructor for the wcsprm struct.">wcsini()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Coordinate transformation parameters.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="b9aeb8cf1afb1bfb22e989580d90fca8"></a><!-- doxytag: member="wcs.h::wcsprt" ref="b9aeb8cf1afb1bfb22e989580d90fca8" args="(const struct wcsprm *wcs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsprt           </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsprt</b>() prints the contents of a <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Coordinate transformation parameters.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="e5cc3f5d249755583403cdf54d2ebb91"></a><!-- doxytag: member="wcs.h::wcsset" ref="e5cc3f5d249755583403cdf54d2ebb91" args="(struct wcsprm *wcs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsset           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsset</b>() sets up a <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct according to information supplied within it (refer to the description of the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct).<p>
<b>wcsset</b>() recognizes the <code><b>NCP</b></code> projection and converts it to the equivalent <code><b>SIN</b></code> projection and likewise translates <code><b>GLS</b></code> into <code><b>SFL</b></code>. It also translates the AIPS spectral types (<code><b>'FREQ-LSR'</b></code>, <code><b>'FELO-HEL'</b></code>, etc.), possibly changing the input header keywords <a class="el" href="structwcsprm.html#e1f462606974e1324cd38f143eda691e">wcsprm::ctype</a> and/or <a class="el" href="structwcsprm.html#c089e5d0e3191255ceaea7f8591b27ea">wcsprm::specsys</a> if necessary.<p>
Note that this routine need not be called directly; it will be invoked by <a class="el" href="wcs_8h.html#27d3dd209db3e76cf4c50f48c01ba986" title="Pixel-to-world transformation.">wcsp2s()</a> and <a class="el" href="wcs_8h.html#60673d05a3513659ac848a9cb3d0cb07" title="World-to-pixel transformation.">wcss2p()</a> if the <a class="el" href="structwcsprm.html#35bff8de85e5a8892e1b68db69ca7a68">wcsprm::flag</a> is anything other than a predefined magic value.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Coordinate transformation parameters.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: Linear transformation matrix is singular.</li><li>4: Inconsistent or unrecognized coordinate axis types.</li><li>5: Invalid parameter value.</li><li>6: Invalid coordinate transformation parameters.</li><li>7: Ill-conditioned coordinate transformation parameters. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="27d3dd209db3e76cf4c50f48c01ba986"></a><!-- doxytag: member="wcs.h::wcsp2s" ref="27d3dd209db3e76cf4c50f48c01ba986" args="(struct wcsprm *wcs, int ncoord, int nelem, const double pixcrd[], double imgcrd[], double phi[], double theta[], double world[], int stat[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsp2s           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ncoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>pixcrd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>imgcrd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>phi</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>theta</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>world</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stat</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsp2s</b>() transforms pixel coordinates to world coordinates.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Coordinate transformation parameters.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ncoord,nelem</em>&nbsp;</td><td>The number of coordinates, each of vector length nelem but containing wcs.naxis coordinate elements. Thus nelem must equal or exceed the value of the <code><b>NAXIS</b></code> keyword unless ncoord == 1, in which case nelem is not used. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pixcrd</em>&nbsp;</td><td>Array of pixel coordinates.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>imgcrd</em>&nbsp;</td><td>Array of intermediate world coordinates. For celestial axes, imgcrd[][wcs.lng] and imgcrd[][wcs.lat] are the projected <img class="formulaInl" alt="$x$" src="form_30.png">-, and <img class="formulaInl" alt="$y$" src="form_31.png">-coordinates in pseudo "degrees". For spectral axes, imgcrd[][wcs.spec] is the intermediate spectral coordinate, in SI units. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>phi,theta</em>&nbsp;</td><td>Longitude and latitude in the native coordinate system of the projection [deg]. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>world</em>&nbsp;</td><td>Array of world coordinates. For celestial axes, world[][wcs.lng] and world[][wcs.lat] are the celestial longitude and latitude [deg]. For spectral axes, imgcrd[][wcs.spec] is the intermediate spectral coordinate, in SI units. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stat</em>&nbsp;</td><td>Status return value for each coordinate:<ul>
<li>0: Success.</li><li>1+: A bit mask indicating invalid pixel coordinate element(s).</li></ul>
</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: Linear transformation matrix is singular.</li><li>4: Inconsistent or unrecognized coordinate axis types.</li><li>5: Invalid parameter value.</li><li>6: Invalid coordinate transformation parameters.</li><li>7: Ill-conditioned coordinate transformation parameters.</li><li>8: One or more of the pixel coordinates were invalid, as indicated by the stat vector. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="60673d05a3513659ac848a9cb3d0cb07"></a><!-- doxytag: member="wcs.h::wcss2p" ref="60673d05a3513659ac848a9cb3d0cb07" args="(struct wcsprm *wcs, int ncoord, int nelem, const double world[], double phi[], double theta[], double imgcrd[], double pixcrd[], int stat[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcss2p           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ncoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>world</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>phi</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>theta</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>imgcrd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>pixcrd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stat</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcss2p</b>() transforms world coordinates to pixel coordinates.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Coordinate transformation parameters.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ncoord,nelem</em>&nbsp;</td><td>The number of coordinates, each of vector length nelem but containing wcs.naxis coordinate elements. Thus nelem must equal or exceed the value of the <code><b>NAXIS</b></code> keyword unless ncoord == 1, in which case nelem is not used. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>world</em>&nbsp;</td><td>Array of world coordinates. For celestial axes, world[][wcs.lng] and world[][wcs.lat] are the celestial longitude and latitude [deg]. For spectral axes, world[][wcs.spec] is the spectral coordinate, in SI units.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>phi,theta</em>&nbsp;</td><td>Longitude and latitude in the native coordinate system of the projection [deg]. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>imgcrd</em>&nbsp;</td><td>Array of intermediate world coordinates. For celestial axes, imgcrd[][wcs.lng] and imgcrd[][wcs.lat] are the projected <img class="formulaInl" alt="$x$" src="form_30.png">-, and <img class="formulaInl" alt="$y$" src="form_31.png">-coordinates in pseudo "degrees". For quadcube projections with a <code><b>CUBEFACE</b></code> axis the face number is also returned in imgcrd[][wcs.cubeface]. For spectral axes, imgcrd[][wcs.spec] is the intermediate spectral coordinate, in SI units. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pixcrd</em>&nbsp;</td><td>Array of pixel coordinates. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stat</em>&nbsp;</td><td>Status return value for each coordinate:<ul>
<li>0: Success.</li><li>1+: A bit mask indicating invalid world coordinate element(s).</li></ul>
</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: Linear transformation matrix is singular.</li><li>4: Inconsistent or unrecognized coordinate axis types.</li><li>5: Invalid parameter value.</li><li>6: Invalid coordinate transformation parameters.</li><li>7: Ill-conditioned coordinate transformation parameters.</li><li>9: One or more of the world coordinates were invalid, as indicated by the stat vector. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="f3f00b876c8212d43f32a51feeadaa81"></a><!-- doxytag: member="wcs.h::wcsmix" ref="f3f00b876c8212d43f32a51feeadaa81" args="(struct wcsprm *wcs, int mixpix, int mixcel, const double vspan[], double vstep, int viter, double world[], double phi[], double theta[], double imgcrd[], double pixcrd[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcsmix           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mixpix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mixcel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>vspan</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>vstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>viter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>world</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>phi</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>theta</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>imgcrd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>pixcrd</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcsmix</b>(), given either the celestial longitude or latitude plus an element of the pixel coordinate, solves for the remaining elements by iterating on the unknown celestial coordinate element using <a class="el" href="wcs_8h.html#60673d05a3513659ac848a9cb3d0cb07" title="World-to-pixel transformation.">wcss2p()</a>. Refer also to the notes below.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Indices for the celestial coordinates obtained by parsing the <a class="el" href="structwcsprm.html#e1f462606974e1324cd38f143eda691e">wcsprm::ctype</a>[].</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mixpix</em>&nbsp;</td><td>Which element of the pixel coordinate is given. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mixcel</em>&nbsp;</td><td>Which element of the celestial coordinate is given:<ul>
<li>1: Celestial longitude is given in world[wcs.lng], latitude returned in world[wcs.lat].</li><li>2: Celestial latitude is given in world[wcs.lat], longitude returned in world[wcs.lng]. </li></ul>
</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>vspan</em>&nbsp;</td><td>Solution interval for the celestial coordinate [deg]. The ordering of the two limits is irrelevant. Longitude ranges may be specified with any convenient normalization, for example [-120,+120] is the same as [240,480], except that the solution will be returned with the same normalization, i.e. lie within the interval specified. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>vstep</em>&nbsp;</td><td>Step size for solution search [deg]. If zero, a sensible, although perhaps non-optimal default will be used. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>viter</em>&nbsp;</td><td>If a solution is not found then the step size will be halved and the search recommenced. viter controls how many times the step size is halved. The allowed range is 5 - 10.</td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>world</em>&nbsp;</td><td>World coordinate elements. world[wcs.lng] and world[wcs.lat] are the celestial longitude and latitude [deg]. Which is given and which returned depends on the value of mixcel. All other elements are given.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>phi,theta</em>&nbsp;</td><td>Longitude and latitude in the native coordinate system of the projection [deg]. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>imgcrd</em>&nbsp;</td><td>Image coordinate elements. imgcrd[wcs.lng] and imgcrd[wcs.lat] are the projected <img class="formulaInl" alt="$x$" src="form_30.png">-, and <img class="formulaInl" alt="$y$" src="form_31.png">-coordinates in pseudo "degrees".</td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>pixcrd</em>&nbsp;</td><td>Pixel coordinate. The element indicated by mixpix is given and the remaining elements are returned.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: Linear transformation matrix is singular.</li><li>4: Inconsistent or unrecognized coordinate axis types.</li><li>5: Invalid parameter value.</li><li>6: Invalid coordinate transformation parameters.</li><li>7: Ill-conditioned coordinate transformation parameters.</li></ul>
10: Invalid world coordinate. 11: No solution found in the specified interval.</dd></dl>
<b>Notes:</b> <br>
 Initially the specified solution interval is checked to see if it's a "crossing" interval. If it isn't, a search is made for a crossing solution by iterating on the unknown celestial coordinate starting at the upper limit of the solution interval and decrementing by the specified step size. A crossing is indicated if the trial value of the pixel coordinate steps through the value specified. If a crossing interval is found then the solution is determined by a modified form of "regula falsi" division of the crossing interval. If no crossing interval was found within the specified solution interval then a search is made for a "non-crossing" solution as may arise from a point of tangency. The process is complicated by having to make allowance for the discontinuities that occur in all map projections.<p>
Once one solution has been determined others may be found by subsequent invokations of <b>wcsmix</b>() with suitably restricted solution intervals.<p>
Note the circumstance that arises when the solution point lies at a native pole of a projection in which the pole is represented as a finite curve, for example the zenithals and conics. In such cases two or more valid solutions may exist but <b>wcsmix</b>() only ever returns one.<p>
Because of its generality <b>wcsmix</b>() is very compute-intensive. For compute-limited applications more efficient special-case solvers could be written for simple projections, for example non-oblique cylindrical projections. 
</div>
</div><p>
<a class="anchor" name="57975833fe0588eb7c7b6d79f13a7693"></a><!-- doxytag: member="wcs.h::wcssptr" ref="57975833fe0588eb7c7b6d79f13a7693" args="(struct wcsprm *wcs, int *i, char ctype[9])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wcssptr           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structwcsprm.html">wcsprm</a> *&nbsp;</td>
          <td class="paramname"> <em>wcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>ctype</em>[9]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>wcssptr</b>() translates the spectral axis in a <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct. For example, a '<code><b>FREQ</b></code>' axis may be translated into <code><b>'ZOPT-F2W'</b></code> and vice versa.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>wcs</em>&nbsp;</td><td>Coordinate transformation parameters. </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>i</em>&nbsp;</td><td>Index of the spectral axis (0-relative). If given &lt; 0 it will be set to the first spectral axis identified from the ctype[] keyvalues in the <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> struct. </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>ctype</em>&nbsp;</td><td>Desired spectral <code><b>CTYPE</b>ia</code>. Wildcarding may be used as for the ctypeS2 argument to <a class="el" href="spc_8h.html#96e8686daa13255e36506c3bfc213e46" title="Spectral keyword translation.">spctrn()</a> as described in the prologue of <a class="el" href="spc_8h.html">spc.h</a>, i.e. if the final three characters are specified as "???", or if just the eighth character is specified as '?', the correct algorithm code will be substituted and returned.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structwcsprm.html" title="Coordinate transformation parameters.">wcsprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: Linear transformation matrix is singular.</li><li>4: Inconsistent or unrecognized coordinate axis types.</li><li>5: Invalid parameter value.</li><li>6: Invalid coordinate transformation parameters.</li><li>7: Ill-conditioned coordinate transformation parameters.</li></ul>
12: Invalid subimage specification (no spectral axis). </dd></dl>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="d16bd8db875ee05b014429efdc1f3471"></a><!-- doxytag: member="wcs.h::wcs_errmsg" ref="d16bd8db875ee05b014429efdc1f3471" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * <a class="el" href="wcs_8h.html#d16bd8db875ee05b014429efdc1f3471">wcs_errmsg</a>[]          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Error messages to match the status value returned from each function. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Nov 24 12:48:54 2010 for WCSLIB 4.6.3 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
